import unittest
import ndnabs

import sys
import os

class TestAuthority(unittest.TestCase):

    def setUp(self):
        db = ndnabs.PickleDb('%s/test_authority.db' % os.path.dirname(os.path.realpath(__file__)))
        self.aa = ndnabs.AttributeAuthority(db)

    def test_apk(self):
        self.assertEqual(self.aa.get_apk(), b'\x80\x03}q\x00(X\x01\x00\x00\x00gq\x01]q\x02(C\x011q\x03C\x15QV/\xb1\xc4\xdf\xd2\xaf\xdbl\x9e\xc5\xdac9\x0e\xe1\x1b\x9b\xe4\x01q\x04eX\x02\x00\x00\x00h0q\x05]q\x06(C\x012q\x07C=K\xd9R\x1b\xcd\xa2q\xa5\x15\xae\xcdZ\x081\x86y\xa3\xa8\xfa\xa4\x02P\xf7\xb3\\C\x06\xc03\x9d>\xa8\xda\x8a\x03\x07\x19I\xf2+\x14\xe7s\x89M8\x95\xa4\x9b\x00\x8a\x8d\xe5IU]\xb3\xc1:\xf2\x01q\x08eX\x02\x00\x00\x00h1q\t]q\n(h\x07C=[O\xab\xfc\x8ap\x87\xfej\x15v\xbe\xba\x83\xd1\xeb\xb0\xc3C\x05\x01\r\xb4^Y\xdbA\xb9\xfe\xca\xebV0\x8c>\xa4\x8cl\x9e\xc4<X=C\xf6\xe3r"\xc0W\x0ekp\xed\x11\xcb\xdf\x9a\\\x18\x01q\x0beX\x02\x00\x00\x00h2q\x0c]q\r(h\x07C=T\x18\x88x\xce;\\\xfc\xcdE}%X2\xfb\xfdu\xc4\xaf<.}C\xb8\xdak\xfb\xdc\xe3\xb7\xd1e\x15\x83\x0e]\x9dW\xe3\x00/\xdcuNvM\x0f\xb3\x8a\xf3\xe3\x06m\xf7\x92\x1f\x03A\xbb~\x01q\x0eeX\x02\x00\x00\x00h3q\x0f]q\x10(h\x07C=kiE\x7f`\xc4\x05\xd3i_,Y\xcb>\xa6\xd3\xa2!\x1d\xc4\x0e*:\x10\xdf\xf5\xe7\x8a\xdc\x02\x03H6\xb5Q\xd1p\xe0\x0b\xa5h\xf1\xe4%\xe6\xb2\x87Sy\xb8\xa1\x81\xb0\xa0\xc4k\'\x14\x99r\x00q\x11eX\x02\x00\x00\x00h4q\x12]q\x13(h\x07C=\x04l\xc4\xb7\xbb3T\x8e\xda\x10\xc1\x87\xbcz/!\xd1c\x1fPL\xce{\x9f\xf5\x15\x08\xfe\xc6\xe1d8fU\xd1\xe8,\x0e\xab\xaa,\x0b\xa8\x9el\xe2\x10}{\xdc!\xbdR\x96\xe1\'\xfa\x0f\xb3\xff\x00q\x14eX\x02\x00\x00\x00A0q\x15]q\x16(h\x07C=Y\xef\n\xefB\xf8\xa0v*w`0\xf9\xf2\xfbJ\xb7`\xf2\xd0l\x97\x0b41\x07\'$.\x17f\x81M\xa2\xeeo\x83k\xf2\xa0J\x98\xeb\xce[\xbd\xeb\xe6\x8d\xf7\xc5\xd8\x83\x88\x8e5\x1d\x10;\xa4\x01q\x17eX\x02\x00\x00\x00A1q\x18]q\x19(h\x07C=\x0c\x14#v\x87n\xbf\x8c:!\xde-\x9a\xdf)\x1a\xd4\x06\xc5DN\x1d\xbei!\xb2\x81Z6\xf8?\xaf3\x1e\xfc\xa8\xc6\xed\xb1\x8e(\xf4/\x1b8\xd6m\xca/]x\xbaQ\xfb\x99\x059\x9a\xba\x19\x01q\x1aeX\x02\x00\x00\x00A2q\x1b]q\x1c(h\x07C=fr$/\x94\xe7\\\xb7\x13W~\x10p\xef\x16\xc0|&W5\x14\x95\xffp\xd5{>.0\x06\x0e\xce\xb9\x84*\x1d\x8f\xec\xc5\xd2\x12-\x9e\xcc#\xf4\x98G#5\xf9\xf2\xda\x03\xd4\xf8\xf4)\xf7S\x01q\x1deX\x02\x00\x00\x00A3q\x1e]q\x1f(h\x07C=\x072\x96\xec\xd8iHm(\xcf\xdaplc{4F\xb0\x8b4;\x82\x1d@\xd9B\xda\x0c\x19\xaea\xb2t\xf8\xba\x7fS\xec\x03\xf0\x0b$ \x9e$\xa5\r> \x94JJ\xe8^H\xd1_\xabh\x8f\x01q eX\x02\x00\x00\x00A4q!]q"(h\x07C=\t.(\xd9O6u\xe2\xf2\xb5\xca\xfb1eG\xff\xe3f\x04\xd81}\x00\x92\xba\x1c\x9e\xba\xc9\x98@\xccR\x95\xa5!;\xb2\xca\xba/|\x13U+\xbc\x8b\x0f\xf3\x1fs\x9f(\xe7\x9a\x1c\xe9\x03\x0c\xb9\x00q#eX\x02\x00\x00\x00B1q$]q%(h\x07C=\x1dZ{\x03\xb3\x157+\x9f\xb7"\xad\xc9y\x1f\xd9\xfe\xc4^\x02!\x1b$.\xe2"\x01\x7f|fDKO\xa0\xed\x1f\x97nS\xf4\x0bJ!\xed\x88\xda\xf5\xc6ys\x94\x04\x0e\x19\t\x1fg\xf0\x0f\x8c\x01q&eX\x02\x00\x00\x00B2q\']q((h\x07C=X\x0c|-@K\xa3b\xd1\xe3u\xc6_H\x1e\xa8[\x16\xeak9\'\x10\xd0\xe9\x7f\x88c@\xdc\x8d\xf8k\xca{S0\xb0\x12=b\xdb\xf7\xed\x90\x83\xc6:V\x93\xa6c\xa5\x88\xcb\xb6\x01v\xaff\x00q)eX\x02\x00\x00\x00B3q*]q+(h\x07C=?\xc6\x05\xd7\x8d\x00XEB\xbdn\x0br\xce\xc0\xda\xdc\x08\x997B\x15\x9b=\xf1\xf1U\x7f~\x05T\xfbwCG\xc7\xb6\xef~\xc7#+\xb7\xee\xf4\xc6u\xb9\xf0\x03.CL\x90ml\t\xe7x"\x01q,eX\x02\x00\x00\x00B4q-]q.(h\x07C=*\x13vU\xea7c\x83\x9a\xacOyM.\xccC\xb2\x92_\xb1#\xc7\xa1+A#\xb3\xc1\x07\xbd\x82\xdb\xe5\x18\xb9\x1b\x902UhT\xd1\x1b[\x82\x036\xc5[.\xc7\'\x9c|\xb6\x86\xe1\xb2\x03D\x00q/eX\x01\x00\x00\x00Cq0]q1(h\x03C\x15\x06\xbaQ<\x92\x11\xb4J\x0bI\x00\xdes\xba=\xd0x\x04\x94\x0e\x00q2eu.')

    def test_get_attr(self):
        attrs1 = self.aa.gen_attr_keys(['FIU', 'Monday', 'Tuesday', 'Wednesday'])
        attrs2 = self.aa.gen_attr_keys(['FIU', 'Monday', 'Tuesday', 'Wednesday'])

        self.assertNotEqual(attrs1, attrs2)

        attrs3 = self.aa.gen_attr_keys(['FIU'], attrs1) # "extending" the attribute set
        self.assertEqual(attrs1, attrs3)

if __name__ == '__main__':
    unittest.main()
